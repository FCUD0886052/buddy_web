
<!doctype html>
<html lang="en">
  
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/web3@1.6.0/dist/web3.min.js"></script>
    
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <!-- <link rel="stylesheet" href="./qq.css"> -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  <a href="../mycase/posted.html" style="color: #606c70">
    <i class="bi bi-arrow-return-left" style="width: 30px; height: 30px;" >
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-return-left" viewBox="0 0 16 16">
        <path fill-rule="evenodd" d="M14.5 1.5a.5.5 0 0 1 .5.5v4.8a2.5 2.5 0 0 1-2.5 2.5H2.707l3.347 3.346a.5.5 0 0 1-.708.708l-4.2-4.2a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 8.3H12.5A1.5 1.5 0 0 0 14 6.8V2a.5.5 0 0 1 .5-.5z"/>
      </svg>
    </i>
    BACK
  </a>

</head>

<body style="background-color: #F8EDEB;">

  <div class="card" style=" background-color: #F8EDEB; border:solid #CCCCBF 0.2pc;">
 
        <span>
          <img style="width: 80px; height: 80px; margin-right: 15px; margin-left: 5px; margin-top: 5px; float: left; border-radius: 50%;"
          src="https://picsum.photos/id/69/100/100" alt="Avatar" class="avatar">
          
          <input id="title" placeholder="請輸入標題" style="position:relative; height: 80px; width: 200px; border: none; background-color: #F8EDEB;"> </input>
            <span>
              <span class="w3-badge" style="margin-bottom:1%; color:#606c70; border-radius: 15%; height: 30px; font-size: 10px; background-color: #8ac6d1; width: 60px;">
                <nobr>
                  <img  src="../B_adobespark.png" style="width: 15px; height: 15px;">
                  <input id="money" placeholder="" style="height: 30px; width: 20px; background-color: #8ac6d1; border: none;"> </input>
                </nobr>
              </span>
            </span>
        </span>

        <div style="margin-top: 1%;">
          <span class="w3-badge" style="margin-bottom:1%; color:#606c70; border-radius: 15px; height: 30px; font-size: 10px; background-color: #CDDAFD; width: 60px;">
            <nobr>
              <input id="hashtag" placeholder="#Hashtag" style="height: 30px; width: 90px; background-color: #CDDAFD; border: none; border-radius: 15px;"> </input>
            </nobr>
          </span>
        </div>

        <div class="card-body">
          <span>
            <textarea id="text" style="height: 400px; width: 300px; border: solid #CCCCBF 0.2pc;" rows="20" cols="40" placeholder="請輸入內文"></textarea>
          </span>

          <div class="dropdown-item">
            <a class="btn dropdown-toggle" href="#">
              教學方式
            </a>
            <ul class="dropdown-menu">
              <select name="cars" id="cars">
                <option value="volvo">面授</option>
                <option value="saab">線上</option>
                <option value="opel">其他</option>
              </select>
            </ul>
          </div>

          <label for="cars">教學方式：</label>
          <select name="cars" id="cars">
            <option value="volvo">面授</option>
            <option value="saab">線上</option>
            <option value="opel">其他</option>
          </select>

          <div>
            <button style="margin-right: 1%; border: none; float: right; background-color: #8ac6d1; color: #606c70; width: 80px; height: 40px; font-weight: 600;" onClick="startt()">發 布</button>
          </div>
        </div>


  </div>

  
      <script> 
        // console.log('c');
        // const web3 = new Web3(new Web3.providers.HttpProvider('http://127.0.0.1:8545'));
        // if(typeof web3 != 'undefined') {
        //   // web3 = new Web3(web3.currentProvider);//搭配metamsk?
        //   console.log('web3 success!');
        // }
        // else{
        //   console.log('web3 fail!');
        // }
        // const accounts = web3.eth.getAccounts();
        // web3.eth.defaultAccount = accounts[0];
        // console.log(web3.version.network);
        const startt = async () => {
          var title = document.getElementById("title").value;
          console.log(title);
          var text = document.getElementById("text").value;
          var pri = document.getElementById("money").value;
          var hash = document.getElementById("hashtag").value;
          console.log(text,pri,hash);
          var g = await 0;
          try {
            const web3 = new Web3(new Web3.providers.HttpProvider('http://127.0.0.1:8545'));
            const accounts = await web3.eth.getAccounts();
            web3.eth.defaultAccount = accounts[0];
            if(typeof web3 != 'undefined') {
              // web3 = new Web3(web3.currentProvider);//搭配metamsk?
              console.log('web3 success!');
            }
            else{
              console.log('web3 fail!');
            }
        
            const PostContract = new web3.eth.Contract([{"inputs":[{"internalType":"string","name":"_title","type":"string"},{"internalType":"string","name":"_text","type":"string"},{"internalType":"uint256","name":"_price","type":"uint256"},{"internalType":"string","name":"_hash","type":"string"}],"name":"_createPost","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"_name","type":"string"},{"internalType":"string","name":"_lineID","type":"string"},{"internalType":"string","name":"_mobile","type":"string"}],"name":"_createUser","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pc","type":"uint256"}],"name":"getl","outputs":[{"internalType":"bool","name":"_lo","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pc","type":"uint256"}],"name":"getpostaddr","outputs":[{"internalType":"address","name":"a","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getpostcount","outputs":[{"internalType":"uint256","name":"j","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pc","type":"uint256"}],"name":"getpostdate","outputs":[{"internalType":"uint256","name":"dat","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pc","type":"uint256"}],"name":"getposthashtag","outputs":[{"internalType":"string","name":"hash","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pc","type":"uint256"}],"name":"getpostlove","outputs":[{"internalType":"bool","name":"_love","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pc","type":"uint256"}],"name":"getpostprice","outputs":[{"internalType":"uint256","name":"pri","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pc","type":"uint256"}],"name":"getposttext","outputs":[{"internalType":"string","name":"te","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pc","type":"uint256"}],"name":"getposttitle","outputs":[{"internalType":"string","name":"ti","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_u","type":"address"}],"name":"getuserlineID","outputs":[{"internalType":"string","name":"l","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_u","type":"address"}],"name":"getusermobile","outputs":[{"internalType":"string","name":"m","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_u","type":"address"}],"name":"getusername","outputs":[{"internalType":"string","name":"n","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"userdata","outputs":[{"internalType":"address","name":"useradd","type":"address"},{"internalType":"string","name":"name","type":"string"},{"internalType":"string","name":"lineID","type":"string"},{"internalType":"string","name":"mobile","type":"string"}],"stateMutability":"view","type":"function"}],'0xa6f83e01e8D3766C3b59EbE54eAa9c380b4f9468');
            PostContract.methods._createPost(title,text,pri,hash).send({from:web3.eth.defaultAccount,gas:6721975,gasPrice:'0'}).then(console.log);
            //新增貼文 成功 0907
            

          } catch(err) {
            console.error("Error:", err);
          } 
        }
    
              </script>
      
        </form>

      <script>

      </script>
       <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous">

       </script>
</body>

</html>